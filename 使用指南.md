# 🎉 Web版微信支付截图OCR识别和去重工具 - 使用指南

## ✅ 项目已部署完成！

您的项目已经成功创建，包含以下组件：

### 📁 项目结构
```
hhg-tools/
├── backend/              # Flask后端（Python）
│   ├── app.py           # API服务
│   ├── ocr_service.py   # OCR识别逻辑
│   └── requirements.txt # Python依赖
│
├── frontend/            # Vue前端
│   ├── src/
│   │   ├── App.vue     # 主界面
│   │   └── main.js     # 入口文件
│   ├── package.json    # NPM依赖
│   └── vite.config.js  # Vite配置
│
├── start.sh            # 一键启动脚本（Mac/Linux）
├── start.bat           # 一键启动脚本（Windows）
├── QUICKSTART.md       # 快速启动指南
└── README_WEB.md       # 完整文档
```

## 🚀 快速启动

### 当前状态

✅ **后端服务**: 已启动在 http://localhost:5001  
✅ **前端服务**: 已启动在 http://localhost:3000  

### 访问应用

在浏览器中打开：**http://localhost:3000**

## 📖 使用流程

### 1. 上传图片
- 拖拽微信支付截图到上传区域
- 或点击上传区域选择文件
- 支持批量上传（JPG、JPEG、PNG格式）

### 2. 开始识别
- 点击"上传并开始识别"按钮
- 系统会自动使用OCR识别订单号和金额
- 处理过程中会显示进度

### 3. 查看结果
处理完成后，可以查看：
- **订单列表**: 所有去重后的订单，按金额排序
- **重复订单**: 被去重的订单详情
- **识别失败**: 无法识别的图片列表
- **统计数据**: 总文件数、成功数、金额汇总等

### 4. 下载文件
- 点击"下载去重后的文件"按钮
- 获得ZIP压缩包，包含所有去重后的图片
- 文件命名格式：`序号_¥金额_原文件名.jpg`

### 5. 处理新文件
- 点击"处理新的文件"按钮
- 返回上传界面继续处理

## 🔧 技术特性

### 后端 (Flask)
- **异步处理**: 使用线程处理OCR任务，避免阻塞
- **任务管理**: 每个上传任务都有唯一ID
- **智能识别**: 支持常规OCR和深度OCR（多种PSM模式）
- **跨行识别**: 处理订单号被换行的情况
- **RESTful API**: 标准的HTTP接口

### 前端 (Vue 3 + Element Plus)
- **现代UI**: 基于Element Plus的美观界面
- **拖拽上传**: 支持拖拽和点击两种上传方式
- **实时进度**: 显示处理进度和状态
- **数据可视化**: 表格、折叠面板展示结果
- **响应式设计**: 适配不同屏幕尺寸

### OCR识别
- **多语言支持**: 中英文混合识别
- **智能提取**: 自动识别订单号和金额
- **去重算法**: 根据订单号自动去重
- **容错处理**: 处理OCR误识别的情况

## ⚙️ 配置说明

### 端口配置
- 后端端口：5001（避免macOS AirPlay Receiver占用5000端口）
- 前端端口：3000
- 代理配置：前端通过Vite代理访问后端API

### 存储位置
- 上传文件：`backend/uploads/{task_id}/`
- 处理结果：`backend/results/{task_id}/`
- 去重文件：`backend/results/{task_id}/deduped/`

## 🛠 停止服务

如果需要停止服务：

```bash
# 查找进程
lsof -ti:5001  # 后端
lsof -ti:3000  # 前端

# 停止进程（替换PID为实际进程号）
kill PID
```

## 🔄 重启服务

如果需要重启服务：

### 后端
```bash
cd backend
./venv/bin/python app.py
```

### 前端
```bash
cd frontend
yarn dev
```

## 📚 API文档

详细的API文档请查看 [README_WEB.md](README_WEB.md)

主要接口：
- `POST /api/upload` - 上传文件
- `POST /api/process/{task_id}` - 开始处理
- `GET /api/status/{task_id}` - 查询状态
- `GET /api/result/{task_id}` - 获取结果
- `GET /api/download/{task_id}` - 下载文件
- `DELETE /api/cleanup/{task_id}` - 清理任务

## ⚠️ 注意事项

1. **OCR准确度**: 识别准确度受图片质量影响，建议使用清晰的截图
2. **处理时间**: 大量图片需要一定处理时间，请耐心等待
3. **存储空间**: 上传的文件会临时存储，建议定期清理
4. **代理设置**: 如果有HTTP代理，可能影响本地服务访问

## 🆘 常见问题

**Q: 端口被占用怎么办？**
```bash
# macOS禁用AirPlay Receiver
系统偏好设置 -> 通用 -> 隔空播放接收器 -> 关闭
```

**Q: OCR识别失败**
- 确保已安装Tesseract OCR和中文语言包
- macOS: `brew install tesseract tesseract-lang`

**Q: 前端无法连接后端**
- 确认后端服务在 http://localhost:5001 运行
- 检查浏览器控制台的错误信息

## 📞 获取帮助

- 查看完整文档：[README_WEB.md](README_WEB.md)
- 快速启动：[QUICKSTART.md](QUICKSTART.md)
- 命令行版本：使用 `python ocr_deduplicate.py --help`

---

🎊 **祝使用愉快！**


